name: CI

on: 

push:

 branches:[master]

 pull_request:
 branches:[master]

jobs:

build:

runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v2
- name: set up python
uses: actions/setup-python@v2
      with:
        python-version: '3.7'

- name: 

- name: Configure AWS credentials from Production account
      uses: aws-actions/configure-aws-credentials@v1
      with:
        aws-access-key-id: ${{ secrets.AKIA6KN4QAMUHTUDDIAG }}
        aws-secret-access-key: ${{ secrets.5MGCk+t3bbyDk4pAHQFuV5gGN/xHtGcw2/yn3qYq }}
        aws-region: us-east-1
        profile_name: default
        project_name: lamdapython
        runtime: python3.7
        
   - name: Run a multi-line script
      run: |
         #install PIP
         python -m pip install --upgrade pip
         #install all dependencies as defined by requirements.txt in the current directory
         pip3 install -r requirements.txt -t .
         #for installing invidividual modules
         #pip3 install Flask -t .
         #zip files into current directory
         zip -r test-dep-dev.zip .
           wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
         sudo dpkg -i google-chrome-stable_current_amd64.deb
         
         #ensuring current working directory is accessible by the function--this might not be doing anything
         export PATH=$PATH:$(pwd)
 
- name: AWS Lambda Deploy
      uses: leyon/lambda-action@v0.0.4
      with:
        function_name: lamdapython
        zip_file: lambdapython.zip